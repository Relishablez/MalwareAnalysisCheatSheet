# MalwareAnalysisCheatSheet

# Theory 

File sigs by header: https://www.garykessler.net/library/file_sigs.html

ASCII tables:
https://www.asciitable.com/
https://www.rapidtables.com/code/text/ascii-table.html

COFF:

https://wiki.osdev.org/COFF


IMAGE_NT_HEADERS32 Structure: 

https://documentation.help/DbgHelp/image_nt_headers_str.htm
https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_nt_headers32

IMAGE_NT_HEADERS64 Structure:

https://documentation.help/DbgHelp/image_nt_headers_str.htm
https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_nt_headers64

PE format:
https://learn.microsoft.com/en-us/windows/win32/debug/pe-format


Important "Optional" Header Field:

Signature (PE32 or PE32+)
AddressOfEntryPoint - relative address to image base, where execution starts from
ImageBase - Preferred address of the first byte of image when loaded into memory - must be a multiple of 64k
SectionAlignment - alignment of sections when they are loaded into memory, mustbe greater than or equal to File alignment
FileAlignment - alignment factor, used to align raw data of sections in image file. If SectionAlignment is < than the architecture's page size then FileAlignment must match SectionAlignment
MajorOperatingSystemVersion
SizeOfImage
Subsystem
DLLCharacteristics


# Tools 

Grab Memory:
MemDump
Dumpit
KAPE https://www.kroll.com/en/services/cyber-risk/incident-response-litigation-support/kroll-artifact-parser-extractor-kape

Fuzzy Hash: SSDEEP: https://ssdeep-project.github.io/ssdeep/index.html


Strings - Windows
Bstrings: https://github.com/EricZimmerman/bstrings / https://ericzimmerman.github.io/#!index.md

Strings - Linux

Strings
BinText
StringSifter
FLOSS


Sandboxes

Cuckoo = https://docs.cuckoosandbox.org/en/latest/

Anlyz - https://sandbox.anlyz.io/

Comodo Valkryie

Deep Freeze

Falcon
